{% extends "base.html" %}
{% load static %}
{% block title %}Admin Dashboard | TicketNow{% endblock %}

{% block content %}
<style>
  body {
    background-color: #f8f9fa;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }
  .card-box {
    border-radius: 8px;
    color: white;
    padding: 1rem;
  }
  .bg-blue { background-color: #007bff; }
  .bg-green { background-color: #28a745; }
  .bg-yellow { background-color: #ffc107; color: #212529; }
  .bg-red { background-color: #dc3545; }
  .quick-action-card {
    border: 1px solid #dee2e6;
    border-radius: 8px;
    padding: 1rem;
    background-color: white;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  }
</style>

<div class="container py-4">

  <h2 class="mb-3 fw-bold"><i class="bi bi-house-door-fill me-2"></i> Admin Dashboard</h2>
  <p class="text-muted">Welcome back, <strong>{{ user.username }}</strong>.</p>

  <!-- Summary Cards -->
  <div class="row g-3 mb-4">
    <div class="col-md-3">
      <div class="card-box bg-blue text-center">
        <h5>Registered Drivers</h5>
        <h3>{{ total_drivers }}</h3>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card-box bg-green text-center">
        <h5>Registered Vehicles</h5>
        <h3>{{ total_vehicles }}</h3>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card-box bg-yellow text-center">
        <h5>Vehicles in Queue</h5>
        <h3>{{ total_queue }}</h3>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card-box bg-red text-center">
        <h5>Total Profit</h5>
        <h3>â‚±{{ total_profit|floatformat:2 }}</h3>
      </div>
    </div>
  </div>

  <!-- Recent Queue Activity -->
  <div class="card mb-4 shadow-sm border-0">
    <div class="card-body">
      <h5 class="card-title mb-3">Recent Queue Activity</h5>

      {% if recent_queues %}
      <div class="table-responsive">
        <table class="table table-striped align-middle">
          <thead class="table-primary">
            <tr>
              <th>#</th>
              <th>Vehicle Plate</th>
              <th>Vehicle Name</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            {% for v in recent_queues %}
            <tr>
              <td>{{ forloop.counter }}</td>
              <td><strong>{{ v.license_plate }}</strong></td>
              <td>{{ v.vehicle_name }}</td>
              <td>
                {% if v.status == "queued" %}
                  <span class="badge bg-warning text-dark">Queued</span>
                {% elif v.status == "boarding" %}
                  <span class="badge bg-info text-dark">Boarding</span>
                {% else %}
                  <span class="badge bg-secondary">Departed</span>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <p class="text-muted text-center"><i class="bi bi-info-circle"></i> No recent activity found.</p>
      {% endif %}
    </div>
  </div>

  <!-- Quick Actions -->
  <h5 class="mb-3">Quick Actions</h5>
  <div class="row g-3 mb-5">
    <div class="col-md-4">
      <a href="{% url 'reports:reports_home' %}" class="text-decoration-none">
          <div class="quick-action-card text-center">
            <h6>Reports & Analytics</h6>
            <p class="small text-muted">View all reports and analytics.</p>
            <span class="btn btn-primary btn-sm">Go</span>
          </div>
      </a>
    </div>

    <div class="col-md-4">
      <a href="{% url 'terminal:manage_routes' %}" class="text-decoration-none">
        <div class="quick-action-card text-center">
          <h6>Manage Routes</h6>
          <p class="small text-muted">Add, edit, or deactivate terminal routes.</p>
          <span class="btn btn-primary btn-sm">Go</span>
        </div>
      </a>
    </div>

    <div class="col-md-4">
      <a href="{% url 'terminal:system_settings' %}" class="text-decoration-none">
        <div class="quick-action-card text-center">
          <h6>System Settings</h6>
          <p class="small text-muted">Configure terminal fees and preferences.</p>
          <span class="btn btn-primary btn-sm">Go</span>
        </div>
      </a>
    </div>
  </div>

  <!-- Footer -->
  <div class="text-end">
    <small class="text-muted">Updated as of {{ now|date:"M d, Y - h:i A" }}</small>
  </div>

</div>
{% endblock %}
