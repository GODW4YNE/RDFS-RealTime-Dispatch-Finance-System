{% extends "base.html" %}
{% load static %}
{% block title %}Admin Dashboard | TicketNow{% endblock %}

{% block content %}
<div class="p-4">
  <h2 class="mb-3"><i class="bi bi-speedometer2"></i> Admin Dashboard</h2>
  <p class="text-muted">Welcome back, <strong>{{ user.username }}</strong>. Here’s a quick summary of terminal operations.</p>

  <!-- Summary Cards -->
  <div class="row g-4 mb-4">
    <div class="col-md-3">
      <div class="card shadow-sm border-0 text-center bg-primary text-white">
        <div class="card-body">
          <i class="bi bi-person-badge fs-2"></i>
          <h6 class="mt-2">Registered Drivers</h6>
          <h3 class="fw-bold">{{ total_drivers }}</h3>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card shadow-sm border-0 text-center bg-success text-white">
        <div class="card-body">
          <i class="bi bi-truck fs-2"></i>
          <h6 class="mt-2">Registered Vehicles</h6>
          <h3 class="fw-bold">{{ total_vehicles }}</h3>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card shadow-sm border-0 text-center bg-warning text-dark">
        <div class="card-body">
          <i class="bi bi-list-check fs-2"></i>
          <h6 class="mt-2">Vehicles in Queue</h6>
          <h3 class="fw-bold">{{ total_queue }}</h3>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card shadow-sm border-0 text-center bg-danger text-white">
        <div class="card-body">
          <i class="bi bi-cash-stack fs-2"></i>
          <h6 class="mt-2">Total Profit</h6>
          <h3 class="fw-bold">₱{{ total_profit|floatformat:2 }}</h3>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Queue Activity -->
  <div class="card shadow-sm border-0 mb-4">
    <div class="card-body">
      <h5 class="card-title mb-3"><i class="bi bi-clock-history text-primary"></i> Recent Queue Activity</h5>
      {% if recent_queues %}
      <div class="table-responsive">
        <table class="table table-striped align-middle">
          <thead class="table-primary">
            <tr>
              <th>#</th>
              <th>Vehicle Plate</th>
              <th>Vehicle Name</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            {% for v in recent_queues %}
            <tr>
              <td>{{ forloop.counter }}</td>
              <td><strong>{{ v.license_plate }}</strong></td>
              <td>{{ v.vehicle_name }}</td>
              <td>
                {% if v.status == "queued" %}
                  <span class="badge bg-warning text-dark">Queued</span>
                {% elif v.status == "boarding" %}
                  <span class="badge bg-info text-dark">Boarding</span>
                {% else %}
                  <span class="badge bg-secondary">Departed</span>
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
        <p class="text-muted text-center"><i class="bi bi-info-circle"></i> No recent activity found.</p>
      {% endif %}
    </div>
  </div>

  <!-- Quick Access -->
  <div class="row mb-5">
    <div class="col-md-4">
      <a href="{% url 'reports:deposit_analytics' %}" class="text-decoration-none">
        <div class="card border-0 shadow-sm h-100 text-center hover-card">
          <div class="card-body">
            <i class="bi bi-bar-chart-line fs-2 text-success"></i>
            <h5 class="mt-2">Reports & Analytics</h5>
            <p class="text-muted small">View deposits, profit trends, and other reports.</p>
          </div>
        </div>
      </a>
    </div>
    <div class="col-md-4">
      <a href="{% url 'terminal:manage_routes' %}" class="text-decoration-none">
        <div class="card border-0 shadow-sm h-100 text-center hover-card">
          <div class="card-body">
            <i class="bi bi-signpost-2 fs-2 text-primary"></i>
            <h5 class="mt-2">Manage Routes</h5>
            <p class="text-muted small">Add, edit, or deactivate terminal routes.</p>
          </div>
        </div>
      </a>
    </div>
    <div class="col-md-4">
      <a href="{% url 'terminal:system_settings' %}" class="text-decoration-none">
        <div class="card border-0 shadow-sm h-100 text-center hover-card">
          <div class="card-body">
            <i class="bi bi-gear fs-2 text-danger"></i>
            <h5 class="mt-2">System Settings</h5>
            <p class="text-muted small">Configure terminal fees, deposit rules, and system preferences.</p>
          </div>
        </div>
      </a>
    </div>
  </div>

  <!-- Footer Info -->
  <div class="text-end">
    <small class="text-muted">Updated as of {{ now|date:"M d, Y - h:i A" }}</small>
  </div>
</div>
{% endblock %}
