{% extends "base.html" %}
{% load static %}

{% block title %}Create New Account | RDFS{% endblock %}

{% block content %}
<style>
    .form-wrapper {
        max-width: 520px;
        margin: auto;
        background: #ffffff;
        padding: 2rem;
        border-radius: 12px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
    }
    .form-title {
        font-weight: 700;
        margin-bottom: .5rem;
    }
    .form-note {
        font-size: .9rem;
        color: #6c757d;
        margin-bottom: 1.6rem;
    }
</style>

<div class="container py-3">

    <div class="form-wrapper">

        <!-- Title -->
        <h3 class="form-title text-center">Create New Account</h3>

        {% if user.role == 'admin' %}
            <p class="form-note text-center">
                As an Admin, you can create both Admin and Staff Admin accounts.
            </p>
        {% else %}
            <p class="form-note text-center">
                As a Staff Admin, you can only create Staff Admin accounts.
            </p>
        {% endif %}

        <!-- Alerts -->
        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show">
                {{ message }}
                <button class="btn-close" data-bs-dismiss="alert"></button>
            </div>
            {% endfor %}
        {% endif %}

        <form method="POST" novalidate>
            {% csrf_token %}

            <!-- Username -->
            <div class="mb-3">
                <label class="form-label fw-semibold">Username</label>
                {{ form.username }}
                {% if form.username.errors %}
                    <div class="text-danger small">{{ form.username.errors.0 }}</div>
                {% endif %}
            </div>

            <!-- Email -->
            <div class="mb-3">
                <label class="form-label fw-semibold">Email Address</label>
                {{ form.email }}
                {% if form.email.errors %}
                    <div class="text-danger small">{{ form.email.errors.0 }}</div>
                {% endif %}
            </div>

            <!-- Role -->
            <div class="mb-3">
                <label class="form-label fw-semibold">Account Role</label>
                {{ form.role }}

                {% if user.role == 'admin' %}
                    <small class="text-muted d-block mt-1">
                        • Choose <strong>Admin</strong> or <strong>Staff Admin</strong>.
                    </small>
                {% else %}
                    <small class="text-muted d-block mt-1">
                        • Only Staff Admin accounts can be created.
                    </small>
                {% endif %}

                {% if form.role.errors %}
                    <div class="text-danger small">{{ form.role.errors.0 }}</div>
                {% endif %}
            </div>

            <!-- Password -->
            <div class="mb-3">
                <label class="form-label fw-semibold">Password</label>
                {{ form.password1 }}
                {% if form.password1.errors %}
                    <div class="text-danger small">{{ form.password1.errors.0 }}</div>
                {% endif %}
            </div>

            <!-- Confirm Password -->
            <div class="mb-3">
                <label class="form-label fw-semibold">Confirm Password</label>
                {{ form.password2 }}
                {% if form.password2.errors %}
                    <div class="text-danger small">{{ form.password2.errors.0 }}</div>
                {% endif %}
            </div>

            <!-- Submit -->
            <div class="d-grid mt-4">
                <button type="submit" class="btn btn-primary btn-lg fw-semibold rounded-pill">
                    <i class="bi bi-person-plus-fill me-2"></i> Create Account
                </button>
            </div>

            <!-- Back -->
            <div class="text-center mt-3">
                <a href="{% url 'accounts:manage_users' %}" class="btn btn-outline-secondary btn-sm rounded-pill">
                    <i class="bi bi-arrow-left-circle-fill me-1"></i> Back to User Management
                </a>
            </div>


        </form>
    </div>

</div>
{% endblock %}
